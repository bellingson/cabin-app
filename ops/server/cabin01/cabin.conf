upstream node_server {
    server 127.0.0.1:3000 fail_timeout=0;
}

server {

    listen 80 default_server;
    listen [::]:80 default_server;
    server_name localhost;

    gzip on;
    gzip_proxied    expired no-cache no-store private auth;
    gzip_types text/css application/x-javascript text/javascript application/json application/javascript image/svg+xml;

    location ~*  ^/assets/.+\.(jpg|jpeg|png|gif|ico|css|js)$ {
       expires 365d;
       alias /opt/cabin/data/$request_uri;
    }

    location / {

        proxy_http_version 1.1;

        proxy_set_header Origin https://$host;
        proxy_set_header Host $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-Proto $scheme;

        proxy_pass http://node_server;

    }
}
